<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SomiSomi ‚Äî Hiring Dashboard</title>
<link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600;700&family=Fraunces:wght@600;700;800&display=swap" rel="stylesheet">
<style>
:root {
  --bg: #FFF8F0;
  --surface: #FFFFFF;
  --surface-alt: #FFF1E6;
  --border: #F0E0D0;
  --text: #2D1B0E;
  --text-soft: #8B7355;
  --accent: #E8572A;
  --accent-hover: #D04A20;
  --accent-light: #FEF0EB;
  --green: #2D8B46;
  --green-light: #EDFAF1;
  --yellow: #D4930D;
  --yellow-light: #FFF8E7;
  --red: #C4342A;
  --red-light: #FEF0EF;
  --blue: #2B6CB0;
  --blue-light: #EBF4FF;
  --radius: 12px;
  --shadow: 0 1px 3px rgba(45,27,14,0.06), 0 4px 12px rgba(45,27,14,0.04);
  --shadow-lg: 0 4px 12px rgba(45,27,14,0.08), 0 12px 32px rgba(45,27,14,0.06);
}
* { margin: 0; padding: 0; box-sizing: border-box; }
body {
  font-family: 'DM Sans', sans-serif;
  background: var(--bg);
  color: var(--text);
  min-height: 100vh;
  -webkit-font-smoothing: antialiased;
}
.container { max-width: 720px; margin: 0 auto; padding: 24px 16px 80px; }
.container.wide { max-width: 900px; }
h1, h2, h3 { font-family: 'Fraunces', serif; }
.page-header { text-align: center; padding: 40px 0 32px; }
.page-header .logo { font-family: 'Fraunces', serif; font-size: 28px; font-weight: 800; color: var(--accent); }
.page-header h1 { font-size: 22px; font-weight: 600; margin-top: 4px; }
.page-header p { color: var(--text-soft); margin-top: 6px; font-size: 15px; }
.card {
  background: var(--surface); border: 1px solid var(--border); border-radius: var(--radius);
  padding: 24px; margin-bottom: 16px; box-shadow: var(--shadow); animation: fadeUp 0.35s ease both;
}
.card-title {
  font-family: 'Fraunces', serif; font-size: 17px; font-weight: 700;
  margin-bottom: 16px; display: flex; align-items: center; gap: 8px;
}
.card-title .icon {
  width: 28px; height: 28px; border-radius: 8px;
  display: flex; align-items: center; justify-content: center; font-size: 14px; flex-shrink: 0;
}
.field { margin-bottom: 16px; }
.field:last-child { margin-bottom: 0; }
.field label {
  display: block; font-size: 13px; font-weight: 600;
  margin-bottom: 6px; letter-spacing: 0.2px;
}
.field label .optional { font-weight: 400; color: var(--text-soft); font-size: 12px; }
input[type="text"],input[type="password"],input[type="email"],select,textarea {
  width: 100%; padding: 10px 14px; border: 1.5px solid var(--border); border-radius: 8px;
  font-family: 'DM Sans', sans-serif; font-size: 15px; color: var(--text);
  background: var(--surface); transition: border-color 0.2s, box-shadow 0.2s; outline: none;
}
input:focus, select:focus, textarea:focus { border-color: var(--accent); box-shadow: 0 0 0 3px var(--accent-light); }
textarea { resize: vertical; min-height: 80px; }
.radio-group { display: flex; gap: 8px; flex-wrap: wrap; }
.radio-group label {
  display: flex; align-items: center; gap: 6px; font-size: 14px; font-weight: 400;
  cursor: pointer; padding: 8px 14px; border: 1.5px solid var(--border); border-radius: 8px;
  transition: all 0.2s; user-select: none;
}
.radio-group label:has(input:checked) {
  border-color: var(--accent); background: var(--accent-light); color: var(--accent); font-weight: 500;
}
.radio-group input { display: none; }
.btn {
  display: inline-flex; align-items: center; justify-content: center; gap: 8px;
  padding: 12px 24px; border: none; border-radius: 8px;
  font-family: 'DM Sans', sans-serif; font-size: 15px; font-weight: 600; cursor: pointer; transition: all 0.2s;
}
.btn-primary {
  background: var(--accent); color: #fff; width: 100%; padding: 14px; font-size: 16px;
  border-radius: 10px; box-shadow: 0 2px 8px rgba(232,87,42,0.25);
}
.btn-primary:hover { background: var(--accent-hover); transform: translateY(-1px); }
.btn-primary:disabled { opacity: 0.6; cursor: not-allowed; transform: none; }
.btn-secondary { background: var(--surface); color: var(--text); border: 1.5px solid var(--border); }
.btn-secondary:hover { background: var(--surface-alt); }
.btn-sm { padding: 8px 16px; font-size: 13px; }
.status-chip {
  display: inline-flex; align-items: center; gap: 4px;
  padding: 4px 10px; border-radius: 20px; font-size: 12px; font-weight: 600;
}
.status-applied { background: var(--blue-light); color: var(--blue); }
.status-interviewed { background: var(--yellow-light); color: var(--yellow); }
.status-hired { background: var(--green-light); color: var(--green); }
.status-rejected { background: var(--red-light); color: var(--red); }
.toast {
  position: fixed; bottom: 24px; left: 50%; transform: translateX(-50%) translateY(100px);
  background: var(--text); color: #fff; padding: 12px 24px; border-radius: 10px;
  font-size: 14px; font-weight: 500; box-shadow: var(--shadow-lg); z-index: 1000;
  transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
}
.toast.show { transform: translateX(-50%) translateY(0); }
.empty-state { text-align: center; padding: 48px 24px; color: var(--text-soft); }
.empty-state .icon { font-size: 40px; margin-bottom: 12px; }
.loading { display: flex; align-items: center; justify-content: center; padding: 60px; }
.spinner {
  width: 32px; height: 32px; border: 3px solid var(--border);
  border-top-color: var(--accent); border-radius: 50%; animation: spin 0.7s linear infinite;
}
@keyframes spin { to { transform: rotate(360deg); } }

/* Login */
#view-login.active { display: flex; align-items: center; justify-content: center; min-height: 80vh; }
.login-card { width: 100%; max-width: 360px; text-align: center; }
.login-card .logo { font-family: 'Fraunces', serif; font-size: 32px; font-weight: 800; color: var(--accent); margin-bottom: 4px; }
.login-card h2 { font-size: 18px; margin-bottom: 24px; color: var(--text-soft); font-weight: 500; font-family: 'DM Sans'; }
.pin-input { text-align: center; font-size: 24px; letter-spacing: 8px; font-weight: 700; padding: 14px; }
.login-error { color: var(--red); font-size: 13px; margin-top: 8px; display: none; }

/* Dashboard */
.dash-toolbar { display: flex; align-items: center; justify-content: space-between; margin-bottom: 16px; flex-wrap: wrap; gap: 10px; }
.dash-toolbar .left { display: flex; gap: 6px; flex-wrap: wrap; }
.filter-btn {
  padding: 6px 14px; border: 1.5px solid var(--border); border-radius: 20px;
  background: var(--surface); font-family: 'DM Sans'; font-size: 13px; font-weight: 500;
  color: var(--text-soft); cursor: pointer; transition: all 0.2s;
}
.filter-btn.active { border-color: var(--accent); background: var(--accent-light); color: var(--accent); font-weight: 600; }
.filter-btn:hover:not(.active) { border-color: #ccc; }
.candidate-list { display: flex; flex-direction: column; gap: 10px; }
.candidate-row {
  display: flex; align-items: center; background: var(--surface); border: 1px solid var(--border);
  border-radius: var(--radius); padding: 16px; cursor: pointer; transition: all 0.2s;
  box-shadow: var(--shadow); gap: 12px; animation: fadeUp 0.35s ease both;
}
.candidate-row:hover { border-color: var(--accent); box-shadow: var(--shadow-lg); transform: translateY(-1px); }
.candidate-row .avatar {
  width: 42px; height: 42px; border-radius: 50%; background: var(--accent-light);
  color: var(--accent); display: flex; align-items: center; justify-content: center;
  font-weight: 700; font-size: 16px; flex-shrink: 0;
}
.candidate-row .info { flex: 1; min-width: 0; }
.candidate-row .name { font-weight: 600; font-size: 15px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.candidate-row .meta { font-size: 13px; color: var(--text-soft); margin-top: 2px; }
.candidate-row .right { display: flex; flex-direction: column; align-items: flex-end; gap: 4px; }

/* Profile */
.profile-back {
  display: inline-flex; align-items: center; gap: 6px; font-size: 14px; font-weight: 500;
  color: var(--text-soft); cursor: pointer; margin-bottom: 16px; padding: 6px 0;
  border: none; background: none; font-family: 'DM Sans';
}
.profile-back:hover { color: var(--accent); }
.profile-header { display: flex; align-items: center; gap: 16px; margin-bottom: 24px; }
.profile-header .avatar {
  width: 56px; height: 56px; border-radius: 50%; background: var(--accent-light);
  color: var(--accent); display: flex; align-items: center; justify-content: center;
  font-weight: 700; font-size: 22px; font-family: 'Fraunces', serif; flex-shrink: 0;
}
.profile-header .details h2 { font-size: 22px; font-weight: 700; }
.profile-header .details .sub { color: var(--text-soft); font-size: 14px; margin-top: 2px; }
.profile-actions { display: flex; gap: 8px; margin-bottom: 24px; flex-wrap: wrap; }
.data-row {
  display: flex; justify-content: space-between; padding: 10px 0;
  border-bottom: 1px solid var(--border); font-size: 14px;
}
.data-row:last-child { border-bottom: none; }
.data-row .label { color: var(--text-soft); flex-shrink: 0; margin-right: 12px; }
.data-row .value { font-weight: 500; text-align: right; }
.vibe-score-bar { display: flex; align-items: center; gap: 8px; margin-bottom: 10px; }
.vibe-score-bar .label { font-size: 13px; color: var(--text-soft); width: 120px; flex-shrink: 0; }
.vibe-score-bar .bar { flex: 1; height: 8px; background: var(--border); border-radius: 4px; overflow: hidden; }
.vibe-score-bar .bar-fill { height: 100%; border-radius: 4px; transition: width 0.5s ease; }
.vibe-score-bar .score { font-size: 13px; font-weight: 600; width: 24px; text-align: right; }

/* Vibe Eval */
.scenario-card {
  background: var(--surface); border: 1px solid var(--border); border-radius: var(--radius);
  padding: 20px; margin-bottom: 12px; box-shadow: var(--shadow); animation: fadeUp 0.35s ease both;
}
.scenario-card .question { font-weight: 600; font-size: 15px; margin-bottom: 4px; }
.scenario-card .hint {
  font-size: 13px; color: var(--green); background: var(--green-light);
  padding: 6px 10px; border-radius: 6px; margin-bottom: 12px; display: inline-block;
}
.rating-btns { display: flex; gap: 6px; flex-wrap: wrap; }
.rating-btns button {
  padding: 8px 14px; border: 1.5px solid var(--border); border-radius: 8px;
  background: var(--surface); font-family: 'DM Sans'; font-size: 13px;
  cursor: pointer; transition: all 0.2s;
}
.rating-btns button:hover { border-color: #bbb; }
.rating-btns button.selected { border-color: var(--accent); background: var(--accent-light); color: var(--accent); font-weight: 600; }
.scenario-note { margin-top: 8px; font-size: 13px; }
.scenario-note input { padding: 8px 12px; font-size: 13px; }
.overall-grade { display: flex; flex-direction: column; gap: 12px; }
.grade-item { display: flex; align-items: center; gap: 12px; }
.grade-item .label { font-size: 14px; width: 140px; flex-shrink: 0; }
.grade-dots { display: flex; gap: 4px; }
.grade-dots button {
  width: 36px; height: 36px; border: 1.5px solid var(--border); border-radius: 8px;
  background: var(--surface); font-size: 14px; font-weight: 600; cursor: pointer;
  transition: all 0.15s; font-family: 'DM Sans'; color: var(--text-soft);
}
.grade-dots button:hover { border-color: #bbb; }
.grade-dots button.selected { border-color: var(--accent); background: var(--accent); color: #fff; }

@media (max-width: 600px) {
  .profile-header { flex-direction: column; text-align: center; }
  .dash-toolbar { flex-direction: column; align-items: stretch; }
  .dash-toolbar .left { justify-content: center; }
  .grade-item { flex-direction: column; align-items: flex-start; gap: 6px; }
}
/* Interview Scheduling */
.upcoming-panel {
  background: var(--blue-light); border: 1.5px solid #c3dafe; border-radius: var(--radius);
  padding: 20px; margin-bottom: 20px; animation: fadeUp 0.35s ease both;
}
.upcoming-panel .panel-title {
  font-family: 'Fraunces', serif; font-size: 16px; font-weight: 700; color: var(--blue);
  display: flex; align-items: center; gap: 8px; margin-bottom: 14px;
}
.upcoming-item {
  display: flex; align-items: center; gap: 12px; padding: 12px; background: #fff;
  border-radius: 10px; margin-bottom: 8px; cursor: pointer; transition: all 0.2s;
  border: 1px solid #e2ecf7;
}
.upcoming-item:last-child { margin-bottom: 0; }
.upcoming-item:hover { border-color: var(--blue); box-shadow: 0 2px 8px rgba(43,108,176,0.1); }
.upcoming-item .date-badge {
  background: var(--blue); color: #fff; border-radius: 10px; padding: 8px 10px;
  text-align: center; min-width: 52px; flex-shrink: 0;
}
.upcoming-item .date-badge .month { font-size: 10px; font-weight: 700; text-transform: uppercase; letter-spacing: 0.5px; }
.upcoming-item .date-badge .day { font-size: 20px; font-weight: 800; line-height: 1.1; font-family: 'Fraunces', serif; }
.upcoming-item .details { flex: 1; min-width: 0; }
.upcoming-item .details .name { font-weight: 600; font-size: 14px; }
.upcoming-item .details .time { font-size: 13px; color: var(--text-soft); margin-top: 2px; }
.upcoming-none { font-size: 13px; color: var(--blue); opacity: 0.7; text-align: center; padding: 8px; }

.interview-badge {
  display: inline-flex; align-items: center; gap: 4px; font-size: 12px; font-weight: 600;
  color: var(--blue); background: var(--blue-light); padding: 3px 8px; border-radius: 6px;
}

.modal-overlay {
  position: fixed; inset: 0; background: rgba(45,27,14,0.4); z-index: 500;
  display: flex; align-items: center; justify-content: center; padding: 16px;
  animation: fadeIn 0.2s ease;
}
.modal {
  background: var(--surface); border-radius: var(--radius); padding: 28px;
  width: 100%; max-width: 400px; box-shadow: var(--shadow-lg); animation: fadeUp 0.3s ease;
}
.modal h3 { font-family: 'Fraunces', serif; font-size: 18px; margin-bottom: 20px; display: flex; align-items: center; gap: 8px; }
.modal .field { margin-bottom: 16px; }
.modal .modal-actions { display: flex; gap: 8px; margin-top: 20px; }
.modal .modal-actions .btn { flex: 1; }
@keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

.view { display: none; }
.view.active { display: block; }
@keyframes fadeUp { from { opacity: 0; transform: translateY(12px); } to { opacity: 1; transform: translateY(0); } }
</style>
</head>
<body>

<div class="toast" id="toast"></div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê LOGIN ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div id="view-login" class="view active">
  <div class="container">
    <div class="login-card card">
      <div class="logo">SomiSomi</div>
      <h2>Hiring Dashboard</h2>
      <div class="field">
        <input type="password" class="pin-input" id="pin-input" placeholder="PIN" maxlength="10">
      </div>
      <div class="login-error" id="login-error">Incorrect PIN. Please try again.</div>
      <button class="btn btn-primary" style="margin-top:16px" onclick="checkPin()">Enter</button>
    </div>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê DASHBOARD ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div id="view-dashboard" class="view">
  <div class="container wide">
    <div class="page-header" style="text-align:left; padding-bottom:20px;">
      <div style="display:flex; justify-content:space-between; align-items:center; flex-wrap:wrap; gap:10px;">
        <div>
          <div class="logo">SomiSomi</div>
          <h1>Hiring Dashboard</h1>
        </div>
        <button class="btn btn-secondary btn-sm" onclick="logoutDash()">üîí Log Out</button>
      </div>
    </div>
    <div class="dash-toolbar">
      <div class="left">
        <button class="filter-btn active" data-filter="all" onclick="setFilter('all',this)">All</button>
        <button class="filter-btn" data-filter="Applied" onclick="setFilter('Applied',this)">üì© Applied</button>
        <button class="filter-btn" data-filter="Interviewed" onclick="setFilter('Interviewed',this)">üí¨ Interviewed</button>
        <button class="filter-btn" data-filter="Hired" onclick="setFilter('Hired',this)">‚úÖ Hired</button>
        <button class="filter-btn" data-filter="Rejected" onclick="setFilter('Rejected',this)">‚ùå Rejected</button>
      </div>
      <button class="btn btn-secondary btn-sm" onclick="refreshDash()">‚Üª Refresh</button>
    </div>
    <div id="upcoming-interviews"></div>
    <div id="candidate-list" class="candidate-list"></div>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê PROFILE ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div id="view-profile" class="view">
  <div class="container">
    <button class="profile-back" onclick="showView('dashboard')">‚Üê Back to Dashboard</button>
    <div id="profile-content"></div>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê VIBE EVALUATION ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div id="view-vibe" class="view">
  <div class="container">
    <button class="profile-back" id="vibe-back-btn">‚Üê Back to Profile</button>
    <div class="page-header" style="text-align:left; padding-top:0;">
      <h1>üéØ Vibe Evaluation</h1>
      <p id="vibe-candidate-name"></p>
    </div>
    <form id="vibe-form">
      <div class="card">
        <div class="card-title"><span class="icon" style="background:var(--accent-light);color:var(--accent)">üë§</span> Interviewer</div>
        <div class="field">
          <label>Your Name *</label>
          <input type="text" name="interviewerName" required placeholder="Employee conducting interview">
        </div>
      </div>
      <!-- Job Overview -->
      <div class="card" style="padding:0; overflow:hidden;">
        <div style="background:var(--surface-alt); padding:16px 24px; display:flex; align-items:center; gap:10px; cursor:pointer; user-select:none;" onclick="document.getElementById('jobOverviewBody').style.display = document.getElementById('jobOverviewBody').style.display === 'none' ? 'block' : 'none'">
          <span style="font-size:20px">üìñ</span>
          <span style="font-family:'Fraunces',serif; font-size:16px; font-weight:700; color:var(--accent);">Job Overview ‚Äì Read to Candidate</span>
          <span style="margin-left:auto; font-size:12px; color:var(--text-soft);">tap to expand/collapse</span>
        </div>
        <div id="jobOverviewBody" style="padding:20px 24px;">
          <div style="margin-bottom:16px; padding-bottom:16px; border-bottom:1px solid var(--border);">
            <div style="font-weight:700; font-size:14px; color:var(--accent); display:flex; align-items:center; gap:8px; margin-bottom:4px;">üí∞ Register</div>
            <p style="font-size:13px; color:var(--text-soft); line-height:1.6; padding-left:28px;">This is the front of house ‚Äî you're the face of SomiSomi. You'll be explaining the menu to customers, answering questions, and making recommendations. Being friendly and outgoing is key here. <strong>This is the person making tips for everyone</strong>, so your energy directly affects the whole team's earnings.</p>
          </div>
          <div style="margin-bottom:16px; padding-bottom:16px; border-bottom:1px solid var(--border);">
            <div style="font-weight:700; font-size:14px; color:var(--accent); display:flex; align-items:center; gap:8px; margin-bottom:4px;">üßá Taiyaki & Ahboong Station</div>
            <p style="font-size:13px; color:var(--text-soft); line-height:1.6; padding-left:28px;">You'll be working with hot surfaces ‚Äî it's like making waffles. You pour the batter, fill it, and press it. <strong>It's all about speed</strong> ‚Äî especially during rushes. You need to keep up with orders while being careful with the hot equipment.</p>
          </div>
          <div style="margin-bottom:16px; padding-bottom:16px; border-bottom:1px solid var(--border);">
            <div style="font-weight:700; font-size:14px; color:var(--accent); display:flex; align-items:center; gap:8px; margin-bottom:4px;">üç¶ Ice Cream Station</div>
            <p style="font-size:13px; color:var(--text-soft); line-height:1.6; padding-left:28px;">This is the last station you'll learn during training. Swirling the soft serve <strong>requires practice</strong> ‚Äî it takes a bit to get the technique down. In the meantime, you can help with fillings for the cones and taiyaki, and asking customers if they want toppings.</p>
          </div>
          <div style="margin-bottom:16px; padding-bottom:16px; border-bottom:1px solid var(--border);">
            <div style="font-weight:700; font-size:14px; color:var(--accent); display:flex; align-items:center; gap:8px; margin-bottom:4px;">üîß Backend / Prep</div>
            <p style="font-size:13px; color:var(--text-soft); line-height:1.6; padding-left:28px;">This is behind the scenes ‚Äî making ingredients, measuring dry ingredients, blending mixes, and restocking stations. It's less customer-facing but just as important to keep everything running smoothly.</p>
          </div>
          <div>
            <div style="font-weight:700; font-size:14px; color:var(--accent); display:flex; align-items:center; gap:8px; margin-bottom:4px;">üíµ Pay & Training</div>
            <p style="font-size:13px; color:var(--text-soft); line-height:1.6; padding-left:28px;"><strong>Pay:</strong> $7.25/hour during your 30-hour training period. After training: $7.25/hour + tips (tips average $3‚Äì4/hour more).<br><strong>Training:</strong> Starts Saturday/Sunday morning, 11:30 AM ‚Äì 3:00 PM. We'll cover all stations and approve you to continue by the end.<br><strong>Motto:</strong> <em>"Be on time, ready to learn, and work with a positive attitude."</em></p>
          </div>
        </div>
      </div>

      <div id="scenario-cards"></div>
      <div class="card" style="margin-top:4px">
        <div class="card-title"><span class="icon" style="background:var(--yellow-light);color:var(--yellow)">‚≠ê</span> Overall Grades (0‚Äì5)</div>
        <div class="overall-grade">
          <div class="grade-item"><span class="label">Attitude</span><div class="grade-dots" data-grade="gradeAttitude"></div></div>
          <div class="grade-item"><span class="label">Communication</span><div class="grade-dots" data-grade="gradeCommunication"></div></div>
          <div class="grade-item"><span class="label">Reliability</span><div class="grade-dots" data-grade="gradeReliability"></div></div>
          <div class="grade-item"><span class="label">Customer Service</span><div class="grade-dots" data-grade="gradeCustomerService"></div></div>
          <div class="grade-item"><span class="label">Energy & Enthusiasm</span><div class="grade-dots" data-grade="gradeEnergy"></div></div>
          <div class="grade-item"><span class="label">Problem Solving</span><div class="grade-dots" data-grade="gradeProblemSolving"></div></div>
        </div>
      </div>
      <div class="card">
        <div class="card-title"><span class="icon" style="background:var(--green-light);color:var(--green)">ü§ù</span> Final Assessment</div>
        <div class="field">
          <label>Would you enjoy working with them?</label>
          <div class="radio-group">
            <label><input type="radio" name="enjoyWorking" value="Yes" required> Yes</label>
            <label><input type="radio" name="enjoyWorking" value="Maybe"> Maybe</label>
            <label><input type="radio" name="enjoyWorking" value="No"> No</label>
          </div>
        </div>
        <div class="field" style="margin-top:12px">
          <label>Would you trust them with closing duties?</label>
          <div class="radio-group">
            <label><input type="radio" name="trustClosing" value="Yes" required> Yes</label>
            <label><input type="radio" name="trustClosing" value="Maybe"> Maybe</label>
            <label><input type="radio" name="trustClosing" value="No"> No</label>
          </div>
        </div>
        <div class="field" style="margin-top:16px">
          <label>Hire Decision *</label>
          <div class="radio-group">
            <label><input type="radio" name="hireDecision" value="Yes" required> ‚úÖ Yes</label>
            <label><input type="radio" name="hireDecision" value="Yes ‚Äì with conditions"> ‚ö†Ô∏è Yes, with conditions</label>
            <label><input type="radio" name="hireDecision" value="No"> ‚ùå No</label>
          </div>
        </div>
        <div class="field" style="margin-top:12px">
          <label>Notes / Conditions <span class="optional">(optional)</span></label>
          <textarea name="vibeNotes" placeholder="Any other thoughts..."></textarea>
        </div>
      </div>
      <button type="submit" class="btn btn-primary" id="vibe-btn">Submit Evaluation</button>
    </form>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê INTERVIEW SCHEDULING MODAL ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div id="schedule-modal" class="modal-overlay" style="display:none" onclick="if(event.target===this)closeScheduleModal()">
  <div class="modal">
    <h3>üìÖ Schedule Interview</h3>
    <div class="field">
      <label>Interview Date *</label>
      <input type="date" id="sched-date" required>
    </div>
    <div class="field">
      <label>Interview Time *</label>
      <input type="time" id="sched-time" required>
    </div>
    <div class="field">
      <label>Notes <span class="optional">(optional)</span></label>
      <input type="text" id="sched-notes" placeholder="e.g. Ask about weekends">
    </div>
    <div class="modal-actions">
      <button class="btn btn-secondary" onclick="closeScheduleModal()">Cancel</button>
      <button class="btn btn-primary" style="width:auto;padding:12px 24px" onclick="saveInterview()">Save</button>
    </div>
  </div>
</div>

<script>
const CONFIG = {
  API_URL: 'https://script.google.com/macros/s/AKfycbxszmTLci5koSFIRwcQNFnV4x8PwvvDZfd2Vd9LSPgX_wLSnyDtCpxnVRMyokGdRBhhdA/exec',
  DASHBOARD_PIN: '1234'
};

let candidates = [];
let currentFilter = 'all';
let currentCandidate = null;
let gradeValues = {};
let scenarioRatings = {};

const SCENARIOS = [
  { q: "Your car breaks down and your shift starts in an hour ‚Äî what do you do?", hint: "‚úÖ Good answer: Calls/texts the store right away, finds a ride (Uber, friend, family), doesn't just no-show" },
  { q: "A customer is upset and yelling about their order being wrong ‚Äî how do you handle it?", hint: "‚úÖ Good answer: Stays calm, apologizes, remakes the order or gets a manager, doesn't argue back" },
  { q: "It's a rush and your coworker hasn't shown up ‚Äî what do you do?", hint: "‚úÖ Good answer: Steps up, covers what they can, lets a manager know, stays positive instead of complaining" },
  { q: "You made a mistake on a customer's order ‚Äî what do you do?", hint: "‚úÖ Good answer: Owns the mistake, apologizes, remakes it quickly, doesn't blame others" },
  { q: "You're on Taiyaki station and the machine starts acting up during a rush ‚Äî what do you do?", hint: "‚úÖ Good answer: Tells a manager right away, doesn't try to force it, helps at another station while it's fixed" },
  { q: "It's closing time but there's still a line of customers ‚Äî how do you handle it?", hint: "‚úÖ Good answer: Serves everyone in line, keeps a good attitude, doesn't rush customers or act annoyed" },
  { q: "You notice a coworker isn't wearing gloves while handling food ‚Äî what do you do?", hint: "‚úÖ Good answer: Politely reminds them, doesn't ignore it, understands food safety comes first" },
  { q: "A customer asks for something that's not on the menu ‚Äî what do you do?", hint: "‚úÖ Good answer: Is polite, checks with a manager if unsure, suggests similar items we do have" }
];

// ‚îÄ‚îÄ Views ‚îÄ‚îÄ
function showView(name) {
  document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
  document.getElementById('view-' + name).classList.add('active');
  window.scrollTo(0, 0);
  if (name === 'dashboard') loadCandidates();
}

// ‚îÄ‚îÄ Toast ‚îÄ‚îÄ
function showToast(msg) {
  const t = document.getElementById('toast');
  t.textContent = msg; t.classList.add('show');
  setTimeout(() => t.classList.remove('show'), 3000);
}

// ‚îÄ‚îÄ Login ‚îÄ‚îÄ
function checkPin() {
  const pin = document.getElementById('pin-input').value;
  if (pin === CONFIG.DASHBOARD_PIN) {
    sessionStorage.setItem('dashAuth', 'true');
    document.getElementById('login-error').style.display = 'none';
    showView('dashboard');
  } else {
    document.getElementById('login-error').style.display = 'block';
    document.getElementById('pin-input').value = '';
    document.getElementById('pin-input').focus();
  }
}
document.getElementById('pin-input').addEventListener('keydown', e => { if (e.key === 'Enter') checkPin(); });

function logoutDash() { sessionStorage.removeItem('dashAuth'); showView('login'); }

// Auto-login if session exists
if (sessionStorage.getItem('dashAuth')) showView('dashboard');

// ‚îÄ‚îÄ Dashboard ‚îÄ‚îÄ
async function loadCandidates() {
  const list = document.getElementById('candidate-list');
  list.innerHTML = '<div class="loading"><div class="spinner"></div></div>';
  try {
    const res = await fetch(CONFIG.API_URL + '?action=getCandidates&pin=' + CONFIG.DASHBOARD_PIN);
    const json = await res.json();
    candidates = json.candidates || [];
    renderCandidates();
  } catch (err) {
    list.innerHTML = '<div class="empty-state"><div class="icon">‚ö†Ô∏è</div><p>Could not load candidates. Check your API URL.</p></div>';
  }
}

function refreshDash() { loadCandidates(); showToast('Refreshed!'); }

function setFilter(filter, btn) {
  currentFilter = filter;
  document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
  btn.classList.add('active');
  renderCandidates();
}

function renderCandidates() {
  const list = document.getElementById('candidate-list');
  let filtered = currentFilter === 'all' ? candidates : candidates.filter(c => c.status === currentFilter);
  if (!filtered.length) {
    list.innerHTML = '<div class="empty-state"><div class="icon">üìã</div><p>No candidates found.</p></div>';
    return;
  }
  list.innerHTML = filtered.map((c, i) => {
    const initials = (c.name || '?').split(' ').map(w => w[0]).join('').toUpperCase().slice(0, 2);
    const statusClass = 'status-' + (c.status || 'applied').toLowerCase();
    const date = c.timestamp ? new Date(c.timestamp).toLocaleDateString() : '';
    return `<div class="candidate-row" onclick="openProfile(${c.row})" style="animation-delay:${i*0.04}s">
      <div class="avatar">${initials}</div>
      <div class="info"><div class="name">${esc(c.name)}</div><div class="meta">${esc(c.phone||'')}${date?' ¬∑ Applied '+date:''}${c.interviewDate?' ¬∑ <span class="interview-badge">üìÖ '+formatInterviewDate(c.interviewDate)+(c.interviewTime?' ¬∑ '+formatInterviewTime(c.interviewTime):'')+'</span>':''}</div></div>
      <div class="right"><span class="status-chip ${statusClass}">${esc(c.status||'Applied')}</span></div>
    </div>`;
  }).join('');
  renderUpcomingInterviews();
}

// ‚îÄ‚îÄ Profile ‚îÄ‚îÄ
async function openProfile(row) {
  showView('profile');
  const content = document.getElementById('profile-content');
  content.innerHTML = '<div class="loading"><div class="spinner"></div></div>';
  try {
    const res = await fetch(CONFIG.API_URL + '?action=getCandidate&row=' + row + '&pin=' + CONFIG.DASHBOARD_PIN);
    const c = await res.json();
    currentCandidate = c; currentCandidate.row = row;
    renderProfile(c);
  } catch (err) {
    content.innerHTML = '<div class="empty-state"><p>Error loading profile.</p></div>';
  }
}

function renderProfile(c) {
  const content = document.getElementById('profile-content');
  const initials = (c.name||'?').split(' ').map(w=>w[0]).join('').toUpperCase().slice(0,2);
  const statusClass = 'status-'+(c.status||'applied').toLowerCase();

  let vibeHTML = '';
  if (c.interviewerName) {
    const grades = [
      {label:'Attitude',val:parseInt(c.gradeAttitude)||0},
      {label:'Communication',val:parseInt(c.gradeCommunication)||0},
      {label:'Reliability',val:parseInt(c.gradeReliability)||0},
      {label:'Customer Service',val:parseInt(c.gradeCustomerService)||0},
      {label:'Energy & Enthusiasm',val:parseInt(c.gradeEnergy)||0},
      {label:'Problem Solving',val:parseInt(c.gradeProblemSolving)||0}
    ];
    const barColor = v => v>=4?'var(--green)':v>=3?'var(--yellow)':'var(--red)';
    vibeHTML = `<div class="card">
      <div class="card-title"><span class="icon" style="background:var(--yellow-light);color:var(--yellow)">üéØ</span> Vibe Evaluation</div>
      <div class="data-row"><span class="label">Interviewer</span><span class="value">${esc(c.interviewerName)}</span></div>
      <div style="margin-top:16px">${grades.map(g=>`<div class="vibe-score-bar"><span class="label">${g.label}</span><div class="bar"><div class="bar-fill" style="width:${g.val*20}%;background:${barColor(g.val)}"></div></div><span class="score">${g.val}</span></div>`).join('')}</div>
      <div style="margin-top:12px">
        <div class="data-row"><span class="label">Enjoy working with?</span><span class="value">${esc(c.enjoyWorking||'‚Äî')}</span></div>
        <div class="data-row"><span class="label">Trust with closing?</span><span class="value">${esc(c.trustClosing||'‚Äî')}</span></div>
        <div class="data-row"><span class="label">Hire Decision</span><span class="value" style="font-weight:700">${esc(c.hireDecision||'‚Äî')}</span></div>
        ${c.vibeNotes?`<div class="data-row"><span class="label">Notes</span><span class="value">${esc(c.vibeNotes)}</span></div>`:''}
      </div>
    </div>`;
  }

  content.innerHTML = `
    <div class="profile-header">
      <div class="avatar">${initials}</div>
      <div class="details"><h2>${esc(c.name)}</h2><div class="sub">${esc(c.phone||'')}${c.email?' ¬∑ '+esc(c.email):''}</div></div>
    </div>
    <div class="profile-actions">
      <span class="status-chip ${statusClass}">${esc(c.status||'Applied')}</span>
      ${!c.interviewerName?`<button class="btn btn-primary btn-sm" onclick="startVibe()">üéØ Start Interview</button>`:''}
      <button class="btn btn-secondary btn-sm" onclick="openScheduleModal()">üìÖ Schedule Interview</button>
      <select class="btn btn-secondary btn-sm" onchange="updateStatus(this.value)" style="cursor:pointer;">
        <option value="">Change Status‚Ä¶</option>
        <option value="Applied">üì© Applied</option>
        <option value="Interviewed">üí¨ Interviewed</option>
        <option value="Hired">‚úÖ Hired</option>
        <option value="Rejected">‚ùå Rejected</option>
      </select>
    </div>
    ${c.interviewDate?`<div class="card" style="border-color:#c3dafe; background:var(--blue-light);">
      <div class="card-title" style="color:var(--blue)"><span class="icon" style="background:#fff;color:var(--blue)">üìÖ</span> Scheduled Interview</div>
      <div class="data-row" style="border-color:#c3dafe"><span class="label">Date</span><span class="value">${formatInterviewDate(c.interviewDate)}</span></div>
      <div class="data-row" style="border-color:#c3dafe"><span class="label">Time</span><span class="value">${formatInterviewTime(c.interviewTime)}</span></div>
      ${c.interviewNotes?`<div class="data-row" style="border-color:#c3dafe"><span class="label">Notes</span><span class="value">${esc(c.interviewNotes)}</span></div>`:''}
      <div style="margin-top:12px"><button class="btn btn-secondary btn-sm" onclick="clearInterview()">‚úï Remove</button></div>
    </div>`:''}
    <div class="card">
      <div class="card-title"><span class="icon" style="background:var(--blue-light);color:var(--blue)">üìÖ</span> Availability & Reliability</div>
      <div class="data-row"><span class="label">Student</span><span class="value">${esc(c.student||'‚Äî')}</span></div>
      <div class="data-row"><span class="label">Other Job</span><span class="value">${esc(c.otherJob||'‚Äî')}${c.otherJobDesc?' ‚Äî '+esc(c.otherJobDesc):''}</span></div>
      <div class="data-row"><span class="label">Available Days</span><span class="value">${esc(c.days||'‚Äî')}</span></div>
      <div class="data-row"><span class="label">Machine Cleaning</span><span class="value">${esc(c.machineCleaning||'‚Äî')}</span></div>
      ${c.schedNotes?`<div class="data-row"><span class="label">Schedule Notes</span><span class="value">${esc(c.schedNotes)}</span></div>`:''}
      <div class="data-row"><span class="label">Hours Preferred</span><span class="value">${esc(c.hoursPreferred||'‚Äî')}</span></div>
      <div class="data-row"><span class="label">Hours Minimum</span><span class="value">${esc(c.hoursMinimum||'‚Äî')}</span></div>
      <div class="data-row"><span class="label">Transportation</span><span class="value">${esc(c.transport||'‚Äî')}</span></div>
      <div class="data-row"><span class="label">Bank Account</span><span class="value">${esc(c.bank||'‚Äî')}</span></div>
      <div class="data-row"><span class="label">Start Immediately</span><span class="value">${esc(c.startNow||'‚Äî')}${c.startDate?' ‚Äî '+esc(c.startDate):''}</span></div>
    </div>
    <div class="card">
      <div class="card-title"><span class="icon" style="background:var(--yellow-light);color:var(--yellow)">üíº</span> Experience</div>
      <div class="data-row"><span class="label">Recent Job</span><span class="value">${esc(c.recentJob||'None')}</span></div>
      ${c.recentJob?`<div class="data-row"><span class="label">Duration</span><span class="value">${esc(c.recentJobLength||'‚Äî')}</span></div><div class="data-row"><span class="label">Reason Left</span><span class="value">${esc(c.recentJobReason||'‚Äî')}</span></div>`:''}
      <div class="data-row"><span class="label">Food Industry</span><span class="value">${esc(c.foodJob||'None')}</span></div>
      ${c.foodJob?`<div class="data-row"><span class="label">Duration</span><span class="value">${esc(c.foodJobLength||'‚Äî')}</span></div><div class="data-row"><span class="label">Reason Left</span><span class="value">${esc(c.foodJobReason||'‚Äî')}</span></div>`:''}
    </div>
    <div class="card">
      <div class="card-title"><span class="icon" style="background:var(--green-light);color:var(--green)">‚úÖ</span> Job Comfort</div>
      <div class="data-row"><span class="label">Standing / Prep / Cleaning</span><span class="value">${esc(c.comfortPhysical||'‚Äî')}</span></div>
      <div class="data-row"><span class="label">Rushes / Difficult Customers</span><span class="value">${esc(c.comfortRush||'‚Äî')}</span></div>
      ${c.notes?`<div class="data-row"><span class="label">Additional Notes</span><span class="value">${esc(c.notes)}</span></div>`:''}
    </div>
    ${vibeHTML}`;
}

// ‚îÄ‚îÄ Status Update ‚îÄ‚îÄ
async function updateStatus(status) {
  if (!status || !currentCandidate) return;
  try {
    const params = new URLSearchParams({
      action: 'updateStatus',
      row: currentCandidate.row,
      pin: CONFIG.DASHBOARD_PIN,
      status: status
    });
    await fetch(CONFIG.API_URL + '?' + params.toString());
    currentCandidate.status = status;
    renderProfile(currentCandidate);
    showToast('Status updated to ' + status);
  } catch (err) { showToast('Error updating status'); }
}

// ‚îÄ‚îÄ Vibe Evaluation ‚îÄ‚îÄ
function startVibe() {
  if (!currentCandidate) return;
  showView('vibe');
  document.getElementById('vibe-candidate-name').textContent = 'Evaluating: ' + currentCandidate.name;
  document.getElementById('vibe-back-btn').onclick = () => openProfile(currentCandidate.row);
  gradeValues = {}; scenarioRatings = {};
  renderScenarios(); renderGradeDots();
}

function renderScenarios() {
  document.getElementById('scenario-cards').innerHTML = SCENARIOS.map((s,i) => `
    <div class="scenario-card" style="animation-delay:${i*0.05}s">
      <div class="question">${i+1}. ${s.q}</div>
      <div class="hint">${s.hint}</div>
      <div class="rating-btns" data-scenario="${i}">
        <button type="button" onclick="rateScenario(${i},'Strong',this)">‚úÖ Strong</button>
        <button type="button" onclick="rateScenario(${i},'Okay',this)">üëç Okay</button>
        <button type="button" onclick="rateScenario(${i},'Weak',this)">‚ö†Ô∏è Weak</button>
        <button type="button" onclick="rateScenario(${i},'Concerning',this)">üö© Concerning</button>
      </div>
      <div class="scenario-note"><input type="text" name="scenarioNote${i}" placeholder="Quick note (optional)"></div>
    </div>`).join('');
}

function rateScenario(idx, rating, btn) {
  scenarioRatings[idx] = rating;
  btn.parentElement.querySelectorAll('button').forEach(b => b.classList.remove('selected'));
  btn.classList.add('selected');
}

function renderGradeDots() {
  document.querySelectorAll('.grade-dots').forEach(container => {
    const key = container.dataset.grade;
    container.innerHTML = [0,1,2,3,4,5].map(n =>
      `<button type="button" onclick="setGrade('${key}',${n},this)">${n}</button>`
    ).join('');
  });
}

function setGrade(key, val, btn) {
  gradeValues[key] = val;
  btn.parentElement.querySelectorAll('button').forEach(b => b.classList.remove('selected'));
  btn.classList.add('selected');
}

document.getElementById('vibe-form').addEventListener('submit', async (e) => {
  e.preventDefault();
  const btn = document.getElementById('vibe-btn');
  btn.disabled = true; btn.textContent = 'Submitting...';
  const fd = new FormData(e.target);
  const data = {
    type:'vibeEval', row:currentCandidate.row, pin:CONFIG.DASHBOARD_PIN,
    interviewerName:fd.get('interviewerName'), enjoyWorking:fd.get('enjoyWorking'),
    trustClosing:fd.get('trustClosing'), hireDecision:fd.get('hireDecision'),
    vibeNotes:fd.get('vibeNotes')||'', ...gradeValues
  };
  SCENARIOS.forEach((s,i) => {
    data['scenario'+i+'Rating'] = scenarioRatings[i]||'';
    data['scenario'+i+'Note'] = fd.get('scenarioNote'+i)||'';
  });
  try {
    await fetch(CONFIG.API_URL, {
      method:'POST', mode:'no-cors',
      headers:{'Content-Type':'text/plain'}, body:JSON.stringify(data)
    });
    showToast('Evaluation submitted!');
    setTimeout(() => openProfile(currentCandidate.row), 800);
  } catch (err) {
    showToast('Error submitting evaluation');
    btn.disabled = false; btn.textContent = 'Submit Evaluation';
  }
});

// ‚îÄ‚îÄ Interview Scheduling ‚îÄ‚îÄ
function formatInterviewDate(dateStr) {
  if (!dateStr) return '‚Äî';
  try {
    const s = String(dateStr).trim();
    let d;
    if (s.match(/^\d{4}-\d{2}-\d{2}$/)) {
      d = new Date(s + 'T12:00:00');
    } else if (s.includes('T')) {
      const datePart = s.split('T')[0];
      d = new Date(datePart + 'T12:00:00');
    } else {
      d = new Date(s);
    }
    if (isNaN(d.getTime())) return s;
    return d.toLocaleDateString('en-US', { weekday: 'short', month: 'short', day: 'numeric', timeZone: 'America/Chicago' });
  } catch { return String(dateStr); }
}

function formatInterviewTime(timeStr) {
  if (!timeStr) return '‚Äî';
  try {
    const s = String(timeStr).trim();
    let h, m;
    if (s.includes('T')) {
      // Google Sheets returns time as "1899-12-30T23:30:00.000Z" (UTC)
      // Parse the full date and convert to Central Time
      const d = new Date(s);
      if (!isNaN(d.getTime())) {
        return d.toLocaleTimeString('en-US', { hour: 'numeric', minute: '2-digit', timeZone: 'America/Chicago' });
      }
      // Fallback: extract time part
      const timePart = s.split('T')[1];
      const bits = timePart.split(':');
      h = parseInt(bits[0]);
      m = bits[1];
    } else if (s.includes(':')) {
      // Simple "17:30" format - already in local time
      const bits = s.split(':');
      h = parseInt(bits[0]);
      m = bits[1];
    } else {
      return s;
    }
    const ampm = h >= 12 ? 'PM' : 'AM';
    const hr12 = h % 12 || 12;
    return `${hr12}:${m} ${ampm}`;
  } catch { return String(timeStr); }
}

function renderUpcomingInterviews() {
  const panel = document.getElementById('upcoming-interviews');
  const now = new Date();
  now.setHours(0,0,0,0);
  const upcoming = candidates
    .filter(c => {
      if (!c.interviewDate) return false;
      const s = String(c.interviewDate).trim();
      const datePart = s.includes('T') ? s.split('T')[0] : s;
      const d = new Date(datePart + 'T00:00:00');
      return !isNaN(d.getTime()) && d >= now;
    })
    .sort((a, b) => {
      const da = a.interviewDate + (a.interviewTime || '00:00');
      const db = b.interviewDate + (b.interviewTime || '00:00');
      return da.localeCompare(db);
    });

  if (!upcoming.length) {
    panel.innerHTML = '';
    return;
  }

  panel.innerHTML = `<div class="upcoming-panel">
    <div class="panel-title">üìÖ Upcoming Interviews</div>
    ${upcoming.map(c => {
      const s = String(c.interviewDate).trim();
      const datePart = s.includes('T') ? s.split('T')[0] : s;
      const d = new Date(datePart + 'T12:00:00');
      const month = !isNaN(d.getTime()) ? d.toLocaleDateString('en-US', { month: 'short', timeZone: 'America/Chicago' }) : '??';
      const day = !isNaN(d.getTime()) ? parseInt(d.toLocaleDateString('en-US', { day: 'numeric', timeZone: 'America/Chicago' })) : '?';
      return `<div class="upcoming-item" onclick="openProfile(${c.row})">
        <div class="date-badge"><div class="month">${month}</div><div class="day">${day}</div></div>
        <div class="details">
          <div class="name">${esc(c.name)}</div>
          <div class="time">${formatInterviewTime(c.interviewTime)}${c.interviewNotes ? ' ¬∑ ' + esc(c.interviewNotes) : ''}</div>
        </div>
        <span class="status-chip status-${(c.status||'applied').toLowerCase()}">${esc(c.status||'Applied')}</span>
      </div>`;
    }).join('')}
  </div>`;
}

function openScheduleModal() {
  const modal = document.getElementById('schedule-modal');
  const dateInput = document.getElementById('sched-date');
  const timeInput = document.getElementById('sched-time');
  const notesInput = document.getElementById('sched-notes');

  // Pre-fill if interview already scheduled
  if (currentCandidate.interviewDate) {
    // Convert to YYYY-MM-DD format for the date input
    const s = String(currentCandidate.interviewDate).trim();
    const datePart = s.includes('T') ? s.split('T')[0] : s;
    dateInput.value = datePart;
    // Handle time - Google Sheets returns "1899-12-30T23:30:00.000Z"
    const timeRaw = String(currentCandidate.interviewTime || '').trim();
    if (timeRaw.includes('T')) {
      const timePart = timeRaw.split('T')[1];
      timeInput.value = timePart.substring(0, 5); // "23:30"
    } else {
      timeInput.value = timeRaw;
    }
    notesInput.value = currentCandidate.interviewNotes || '';
  } else {
    dateInput.value = '';
    timeInput.value = '';
    notesInput.value = '';
  }

  // Set min date to today
  const today = new Date().toISOString().split('T')[0];
  dateInput.min = today;

  modal.style.display = 'flex';
}

function closeScheduleModal() {
  document.getElementById('schedule-modal').style.display = 'none';
}

async function saveInterview() {
  const dateVal = document.getElementById('sched-date').value;
  const timeVal = document.getElementById('sched-time').value;
  const notesVal = document.getElementById('sched-notes').value;

  if (!dateVal || !timeVal) {
    showToast('Please enter both date and time');
    return;
  }

  try {
    const params = new URLSearchParams({
      action: 'scheduleInterview',
      row: currentCandidate.row,
      pin: CONFIG.DASHBOARD_PIN,
      interviewDate: dateVal,
      interviewTime: timeVal,
      interviewNotes: notesVal
    });
    await fetch(CONFIG.API_URL + '?' + params.toString());
    currentCandidate.interviewDate = dateVal;
    currentCandidate.interviewTime = timeVal;
    currentCandidate.interviewNotes = notesVal;
    closeScheduleModal();
    renderProfile(currentCandidate);
    showToast('Interview scheduled for ' + formatInterviewDate(dateVal) + ' at ' + formatInterviewTime(timeVal));
  } catch (err) {
    showToast('Error scheduling interview');
  }
}

async function clearInterview() {
  if (!confirm('Remove the scheduled interview?')) return;
  try {
    const params = new URLSearchParams({
      action: 'scheduleInterview',
      row: currentCandidate.row,
      pin: CONFIG.DASHBOARD_PIN,
      interviewDate: '',
      interviewTime: '',
      interviewNotes: ''
    });
    await fetch(CONFIG.API_URL + '?' + params.toString());
    currentCandidate.interviewDate = '';
    currentCandidate.interviewTime = '';
    currentCandidate.interviewNotes = '';
    renderProfile(currentCandidate);
    showToast('Interview removed');
  } catch (err) {
    showToast('Error removing interview');
  }
}

function esc(str) { if(!str)return''; const d=document.createElement('div'); d.textContent=str; return d.innerHTML; }
</script>
</body>
</html>
